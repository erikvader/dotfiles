name=
source=$(name).tex
output=$(name).pdf

.PHONY: all
all: $(output)

.PHONY: force
force:
	rm -f $(output)
	$(MAKE) --no-print-directory all

$(output): $(source)
	latexmk -pdf -pdflatex="pdflatex -interaction=nonstopmode" -use-make $<

.PHONY: auto
auto:
	@while true; do \
		inotifywait --event modify $(source) &>/dev/null; \
		$(MAKE) --no-print-directory all; \
	done

.PHONY: show
show: $(output)
	xdg-open $< &>/dev/null &

# clean everything
.PHONY: clean
clean:
	latexmk -C

# remove temporary stuff and keep the PDF
.PHONY: finalize
finalize:
	latexmk -c
